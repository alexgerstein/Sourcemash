var feeds=feeds||{};

(function(){'use strict';feeds.Feed=Backbone.Model.extend({});})();var feeds=feeds||{};

(function(){'use strict';feeds.FeedListCollection=Backbone.Collection.extend({model:feeds.Feed,url:'/api/subscriptions',parse:function(response){return response.subscriptions;},comparator:function(feed){ return feed.attributes.title.toLowerCase()}}); feeds.feedList=new feeds.FeedListCollection();})();var feeds=feeds||{};

(function($){'use strict';feeds.FeedView=Backbone.View.extend({tagName:'li',template:_.template($('#feed-template').html()),render:function(){this.$el.html(this.template(this.model.toJSON()));return this;}});feeds.FeedsView=Backbone.View.extend({el:'.feeds',initialize:function(){this.input=$('#url');this.csrf=$("#csrf_token")
feeds.feedList.on('sync',this.addAll,this);feeds.feedList.fetch();},events:{'keypress #url':'createFeedOnEnter','click button[type="submit"]':'createFeedOnClick'},createFeedOnClick:function(e){feeds.feedList.create(this.newAttributes(),{wait:true,success:this.clear_input});feeds.feedList.fetch(); return false;},createFeedOnEnter:function(e){if(e.which!==13||!this.input.val().trim()){ return;}
feeds.feedList.create(this.newAttributes(),{wait:true,success:this.clear_input});feeds.feedList.fetch(); return false;},clear_input:function(){this.input.val('');},addOne:function(feed){var view=new feeds.FeedView({model:feed});$('#feed-list').append(view.render().el);},addAll:function(){$('#feed-list').html(''); feeds.feedList.each(this.addOne,this);},newAttributes:function(){return{url:this.input.val(),csrf_token:this.csrf.val()}}});
feeds.FeedsView=new feeds.FeedsView();})(jQuery);